mydata <- read.delim("./DE_tutorial/output/normdata.txt", as.is=T)
design <- read.csv("./DE_tutorial/YChrom_design.csv")
colnames(mydata) <- design$Group
mydata <- na.omit(mydata)
mydata <- t(scale(t(mydata)))
wss <- (nrow(mydata)-1)*sum(apply(mydata,2,var))
for (i in 2:15) wss[i] <- sum(kmeans(mydata,
   centers=i)$withinss)
png("SSQ_by_K_using_kmeans.png", width=600, heigh=500)
  plot(1:15, wss, type="b", xlab="Number of Clusters",
    ylab="Within groups sum of squares") 
dev.off()
fit <- kmeans(mydata, 10) 
class(fit)
mydata2 <- data.frame(mydata, fit$cluster) 
head(mydata2)
aggregate(mydata,by=list(fit$cluster),FUN=mean)
library(cluster)
png("Clusplot_kmeans_k5.png", width=600, heigh=500)
  clusplot(mydata, fit$cluster, color=TRUE, shade=TRUE,
   labels=2, lines=0)
dev.off()
library(factoextra)
png("fviz_cluster_kmeans_k5.png", width=600, heigh=500)
  fviz_cluster(fit, data = mydata)
dev.off()
d <- dist(t(mydata), method = "euclidean") # distance matrix
fit <- hclust(d, method="ward.D")
png("hclust_samples.png", width=600, heigh=500)
  plot(fit, hang = -1, cex = 0.8) # display dendogram
dev.off()
groups <- cutree(fit, k=5) # cut tree into 5 clusters
groups
png("rect_hclust_samples.png", width=600, heigh=500)
  plot(fit, hang = -1, cex = 0.8) # display dendogram
  rect.hclust(fit, k=5, border="red") 
dev.off()
gd <- get_dist(mydata, method ="pearson", stand=FALSE)
gfit <- hclust(gd, method="ward.D")
png("hclust_genes.png", width=600, heigh=500)
  plot(gfit, hang = -1, cex = 0.8, labels = FALSE) # display dendogram
dev.off()
ls
library(preprocessCore)
install.packages("preprocessCore")
q()
mydata <- read.delim("./DE_tutorial/output/normdata.txt", as.is=T)
design <- read.csv("./DE_tutorial/YChrom_design.csv")
colnames(mydata) <- design$Group
mydata <- na.omit(mydata) 
mydata <- t(scale(t(mydata)))
wss <- (nrow(mydata)-1)*sum(apply(mydata,2,var))
for (i in 2:15) wss[i] <- sum(kmeans(mydata,
   centers=i)$withinss)

png("SSQ_by_K_using_kmeans.png", width=600, heigh=500)
  plot(1:15, wss, type="b", xlab="Number of Clusters",
    ylab="Within groups sum of squares") 
dev.off()
fit <- kmeans(mydata, 10) 
class(fit)
mydata2 <- data.frame(mydata, fit$cluster) 
head(mydata2)
aggregate(mydata,by=list(fit$cluster),FUN=mean)
library(cluster)

png("Clusplot_kmeans_k5.png", width=600, heigh=500)
  clusplot(mydata, fit$cluster, color=TRUE, shade=TRUE,
   labels=2, lines=0)
dev.off()
library(factoextra)
png("fviz_cluster_kmeans_k5.png", width=600, heigh=500)
  fviz_cluster(fit, data = mydata)
dev.off()
d <- dist(t(mydata), method = "euclidean") # distance matrix
fit <- hclust(d, method="ward.D")
png("hclust_samples.png", width=600, heigh=500)
  plot(fit, hang = -1, cex = 0.8) # display dendogram
dev.off()
groups <- cutree(fit, k=5) # cut tree into 5 clusters
groups
png("rect_hclust_samples.png", width=600, heigh=500)
  plot(fit, hang = -1, cex = 0.8) # display dendogram
  rect.hclust(fit, k=5, border="red") 
dev.off()
gd <- get_dist(mydata, method ="pearson", stand=FALSE)
gfit <- hclust(gd, method="ward.D")
png("hclust_genes.png", width=600, heigh=500)
  plot(gfit, hang = -1, cex = 0.8, labels = FALSE) # display dendogram
dev.off()
q()
